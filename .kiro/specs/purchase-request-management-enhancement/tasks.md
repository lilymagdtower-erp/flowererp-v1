# 구매 요청 관리 시스템 개선 구현 계획

## 구현 작업 목록

- [x] 1. 자재 카테고리 표시 및 필터링 개선


  - 자재 선택 테이블에서 카테고리 컬럼이 올바르게 표시되도록 수정
  - 카테고리 드롭다운에서 실제 자재 데이터의 카테고리가 표시되도록 개선
  - 카테고리 필터링 로직 수정 및 테스트
  - _요구사항: 1.1, 1.2, 1.3_



- [ ] 2. 사용자 역할 관리 시스템 구현
  - UserRole 타입 및 인터페이스 정의
  - 역할 기반 접근 제어 훅 (useUserRole) 구현

  - Firebase Security Rules에 역할 기반 접근 제어 추가
  - _요구사항: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 3. 구매 요청 취합 데이터 모델 구현

  - ConsolidatedItem 및 관련 타입 정의
  - 구매 요청 취합 로직 구현 (consolidateRequests 함수)
  - 취합 데이터 계산 및 변환 유틸리티 함수 작성
  - _요구사항: 2.1, 2.2, 2.5_

- [x] 4. 취합된 구매 요청 표시 컴포넌트 구현


  - ConsolidatedRequestView 컴포넌트 생성
  - 지점별 수량을 표시하는 테이블 구조 구현
  - 상품명, 거래처명, 가격, 지점별 수량 컬럼 구현
  - _요구사항: 2.2, 2.5, 7.1, 7.2_

- [x] 5. 본사 관리자 가격 및 거래처 수정 기능 구현


  - 인라인 편집 가능한 가격 입력 필드 구현
  - 거래처명 수정 기능 구현
  - 변경사항 저장 및 검증 로직 구현
  - _요구사항: 2.3, 2.4, 4.1_

- [x] 6. 구매 요청 상세 팝업 구현


  - RequestDetailPopup 컴포넌트 생성
  - 구매 요청 목록 행 클릭 이벤트 처리
  - 팝업에서 거래처 및 가격 편집 기능 구현
  - 편집 권한에 따른 읽기 전용/편집 모드 구분
  - _요구사항: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ] 7. 구매 요청 상태 관리 시스템 구현
  - StatusManager 컴포넌트 구현
  - 상태 전이 검증 로직 구현
  - 상태 변경 이력 추적 기능 구현
  - 상태 변경 시 알림 발송 기능 구현
  - _요구사항: 3.1, 3.2, 3.3, 3.4_

- [ ] 8. 가격 변경 이력 관리 시스템 구현
  - PriceHistory 데이터 모델 구현
  - 가격 변경 시 이력 저장 로직 구현
  - 가격 변경이 자재 관리에 반영되는 기능 구현
  - 가격 변경 알림 시스템 구현
  - _요구사항: 4.1, 4.2, 4.3_

- [x] 9. 역할별 메뉴 분리 구현



  - 지점 사용자용 "새 구매 요청" 페이지 분리
  - 본사 관리자용 "구매 요청 관리" 페이지 구현
  - 역할 기반 라우팅 및 접근 제어 구현
  - 네비게이션 메뉴에 역할별 표시 로직 추가
  - _요구사항: 6.1, 6.2, 6.3, 6.4_

- [ ] 10. 취합 데이터 시각화 기능 구현
  - 지점별 수량 컬러 코딩 구현
  - 우선순위 표시 로직 구현
  - 긴급 요청 특별 표시 기능 구현
  - Excel 내보내기 기능 구현
  - _요구사항: 7.1, 7.2, 7.3, 7.4_

- [ ] 11. 실시간 알림 시스템 개선
  - 새 구매 요청 제출 시 본사 관리자 알림
  - 상태 변경 시 지점 알림 기능
  - 가격 변경 시 관련 지점 알림 기능
  - 긴급 요청 즉시 알림 기능
  - _요구사항: 8.1, 8.2, 8.3, 8.4_

- [ ] 12. Firebase Security Rules 업데이트
  - 역할 기반 접근 제어 규칙 구현
  - 데이터 검증 규칙 추가
  - 감사 로그 접근 제어 규칙 구현
  - 테스트 및 검증
  - _요구사항: 6.3, 보안 요구사항_

- [ ] 13. 성능 최적화 구현
  - 대량 데이터 처리를 위한 페이지네이션 구현
  - 취합 데이터 로딩 최적화
  - 실시간 업데이트 성능 개선
  - 모바일 반응형 최적화
  - _요구사항: 성능 요구사항_

- [ ] 14. 통합 테스트 및 버그 수정
  - 전체 워크플로우 테스트
  - 역할별 접근 권한 테스트
  - 데이터 일관성 검증
  - 발견된 버그 수정 및 재테스트
  - _요구사항: 모든 요구사항 검증_

- [ ] 15. 문서화 및 사용자 가이드 작성
  - API 문서 업데이트
  - 사용자 매뉴얼 작성
  - 관리자 가이드 작성
  - 개발자 문서 업데이트
  - _요구사항: 유지보수성 향상_